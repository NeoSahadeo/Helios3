var p=Object.defineProperty;var g=(e,s,t)=>s in e?p(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t;var r=(e,s,t)=>g(e,typeof s!="symbol"?s+"":s,t);import{w as u,b as w}from"./paths.R4-ERajV.js";class b{constructor(){r(this,"subscribe");r(this,"set");r(this,"update");r(this,"content");const{subscribe:s,set:t,update:o}=u();this.subscribe=s,this.set=t,this.update=o,this.content=null}open(){this.set(!0)}close(){this.set(!1)}}const _=new b,T=u([]);class k{constructor(){r(this,"subscribe");r(this,"set");r(this,"update");const{subscribe:s,set:t,update:o}=u([]);this.subscribe=s,this.set=t,this.update=o}send({message:s="",timeout_ms:t=3e3,dismissable:o=!0,type:n="info"}){if(!o&&t==0){console.error("Cannot have dismissable: true and timeout_ms: 0");return}const d=Math.random();this.update(c=>[...c,{id:d,message:s,dismissable:o,type:n}]),t>0&&setTimeout(()=>{this.update(c=>c.filter(h=>h.id!=d))},t)}remove(s){this.update(t=>t.filter(o=>o.id!=s))}}const f=new k;function l(){let e=localStorage.getItem("helios3token");return e||(e=sessionStorage.getItem("helios3token"),e)?e:null}function y(){sessionStorage.removeItem("helios3token"),localStorage.removeItem("helios3token")}async function $(){const e=l();if(e!=null)try{const s=await fetch(a("api")+"passwords",{headers:{Authorization:`Token ${e}`}});if(s.ok){const t=await s.json();return t.error?void 0:t}}catch(s){console.log(s)}}function a(e){if(w===""){if(e==="api")return"http://127.0.0.1:8000/";if(e==="local")return"http://localhost:5173/"}return e==="api"?"https://neosahadeo.pythonanywhere.com/":e==="local"?"https://neosahadeo.github.io/Helios3/":""}async function j(){const e=l();if(!e)return!1;try{return(await fetch(a("api")+"loggedin",{headers:{Authorization:`Token ${e}`}})).ok?!0:(y(),!1)}catch(s){console.error(s)}}async function i(e,s){const t=l();if(t)try{let o;if(s!=="get"?o=await fetch(a("api")+"passwords",{method:s,headers:{Authorization:`Token ${t}`},body:e}):o=await fetch(a("api")+`passwords?q=${e.get("q")}`,{method:s,headers:{Authorization:`Token ${t}`}}),o.ok){const n=await o.json();return n.error?f.send({message:n.error,type:"error"}):s!=="get"&&f.send({message:n.success,type:"success"}),n}return}catch(o){console.error(o);return}}async function z(e){return i(e,"delete")}async function A(e){return i(e,"put")}async function I(e){return i(e,"post")}async function S(e){return i(e,"get")}export{I as c,z as d,A as e,$ as f,l as g,j as i,_ as m,f as n,T as p,y as r,S as s,a as u};
